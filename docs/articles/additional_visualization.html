<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="variancePartition">
<title>Additional visualizations of variance structure â€¢ variancePartition</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Additional visualizations of variance structure">
<meta property="og:description" content="variancePartition">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">variancePartition</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.28.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/FAQ.html">Frequently asked questions</a>
    <a class="dropdown-item" href="../articles/additional_visualization.html">Additional visualizations of variance structure</a>
    <a class="dropdown-item" href="../articles/dream.html">dream</a>
    <a class="dropdown-item" href="../articles/theory_practice_random_effects.html">Theory and practice of random effects and REML</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/DiseaseNeuroGenomics/variancePartition/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Additional visualizations of variance structure</h1>
                        <h4 data-toc-skip class="author">Developed by <a href="http://gabrielhoffman.github.io/" class="external-link">Gabriel Hoffman</a>
</h4>
            
            <h4 data-toc-skip class="date">Run on 2023-01-19
12:12:54</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/DiseaseNeuroGenomics/variancePartition/blob/HEAD/vignettes/additional_visualization.Rmd" class="external-link"><code>vignettes/additional_visualization.Rmd</code></a></small>
      <div class="d-none name"><code>additional_visualization.Rmd</code></div>
    </div>

    
    
<p>The correlation structure between samples in complex study designs
can be decomposed into the contribution of multiple dimensions of
variation. <code>variancePartition</code> provides a statistical and
visualization framework to interpret sources of variation. Here I
describe a visualization of the correlation structure between samples
for a single gene.</p>
<p>In the example dataset described in the main vignette, samples are
correlated because they can come from the same individual or the same
tissue. The function <code><a href="../reference/plotCorrStructure.html">plotCorrStructure()</a></code> shows the
correlation structure caused by each variable as well and the joint
correlation structure. Figure 1 shows the correlation between samples
from the same individual where (a) shows the samples sorted based on
clustering of the correlation matrix and (b) shows the original order.
Figure 1 c) and d) shows the same type of plot except demonstrating the
effect of tissue. The total correlation structure from summing
individual and tissue correlation matricies is shown in Figure 2. The
code to generate these plots is shown below.</p>
<div class="section level2">
<h2 id="plot-variance-structure">Plot variance structure<a class="anchor" aria-label="anchor" href="#plot-variance-structure"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit linear mixed model and examine correlation stucture</span></span>
<span><span class="co"># for one gene</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">varPartData</span><span class="op">)</span></span>
<span></span>
<span><span class="va">form</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">Age</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Individual</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Tissue</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fitList</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitVarPartModel-method.html">fitVarPartModel</a></span><span class="op">(</span> <span class="va">geneExpr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="op">]</span>, <span class="va">form</span>, <span class="va">info</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># focus on one gene</span></span>
<span><span class="va">fit</span> <span class="op">=</span> <span class="va">fitList</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<div class="section level3">
<h3 id="by-individual">By Individual<a class="anchor" aria-label="anchor" href="#by-individual"></a>
</h3>
<div class="section level4">
<h4 id="reorder-samples">Reorder samples<a class="anchor" aria-label="anchor" href="#reorder-samples"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure 1a</span></span>
<span><span class="co"># correlation structure based on similarity within Individual</span></span>
<span><span class="co"># reorder samples based on clustering</span></span>
<span><span class="fu"><a href="../reference/plotCorrStructure.html">plotCorrStructure</a></span><span class="op">(</span> <span class="va">fit</span>, <span class="st">"Individual"</span> <span class="op">)</span></span></code></pre></div>
<p><img src="additional_visualization_files/figure-html/corStructa-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="original-order-of-samples">Original order of samples<a class="anchor" aria-label="anchor" href="#original-order-of-samples"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure 1b</span></span>
<span><span class="co"># use original order of samples</span></span>
<span><span class="fu"><a href="../reference/plotCorrStructure.html">plotCorrStructure</a></span><span class="op">(</span> <span class="va">fit</span>, <span class="st">"Individual"</span>, reorder<span class="op">=</span><span class="cn">FALSE</span> <span class="op">)</span></span></code></pre></div>
<p><img src="additional_visualization_files/figure-html/corStructb-1.png" width="672"></p>
</div>
</div>
<div class="section level3">
<h3 id="by-tissue">By Tissue<a class="anchor" aria-label="anchor" href="#by-tissue"></a>
</h3>
<div class="section level4">
<h4 id="reorder-samples-1">Reorder samples<a class="anchor" aria-label="anchor" href="#reorder-samples-1"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure 1c</span></span>
<span><span class="co"># correlation structure based on similarity within Tissue</span></span>
<span><span class="co"># reorder samples based on clustering</span></span>
<span><span class="fu"><a href="../reference/plotCorrStructure.html">plotCorrStructure</a></span><span class="op">(</span> <span class="va">fit</span>, <span class="st">"Tissue"</span> <span class="op">)</span></span></code></pre></div>
<p><img src="additional_visualization_files/figure-html/corStructc-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="original-order-of-samples-1">Original order of samples<a class="anchor" aria-label="anchor" href="#original-order-of-samples-1"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure 1d</span></span>
<span><span class="co"># use original order of samples</span></span>
<span><span class="fu"><a href="../reference/plotCorrStructure.html">plotCorrStructure</a></span><span class="op">(</span> <span class="va">fit</span>, <span class="st">"Tissue"</span>, reorder<span class="op">=</span><span class="cn">FALSE</span> <span class="op">)</span></span></code></pre></div>
<p><img src="additional_visualization_files/figure-html/corStructd-1.png" width="672"></p>
</div>
</div>
<div class="section level3">
<h3 id="by-individual-and-tissue">By Individual and Tissue<a class="anchor" aria-label="anchor" href="#by-individual-and-tissue"></a>
</h3>
<div class="section level4">
<h4 id="reorder-samples-2">Reorder samples<a class="anchor" aria-label="anchor" href="#reorder-samples-2"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure 2a</span></span>
<span><span class="co"># correlation structure based on similarity within </span></span>
<span><span class="co"># Individual *and* Tissue, reorder samples based on clustering</span></span>
<span><span class="fu"><a href="../reference/plotCorrStructure.html">plotCorrStructure</a></span><span class="op">(</span> <span class="va">fit</span> <span class="op">)</span></span></code></pre></div>
<p><img src="additional_visualization_files/figure-html/corStructe-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="original-order-of-samples-2">Original order of samples<a class="anchor" aria-label="anchor" href="#original-order-of-samples-2"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure 2b</span></span>
<span><span class="co"># use original order of samples</span></span>
<span><span class="fu"><a href="../reference/plotCorrStructure.html">plotCorrStructure</a></span><span class="op">(</span> <span class="va">fit</span>, reorder<span class="op">=</span><span class="cn">FALSE</span> <span class="op">)</span></span></code></pre></div>
<p><img src="additional_visualization_files/figure-html/corStructf-1.png" width="672"></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="http://gabrielhoffman.github.io" class="external-link">Gabriel Hoffman</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
